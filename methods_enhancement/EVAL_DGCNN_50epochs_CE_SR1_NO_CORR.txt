Cannot import torchlars
Cannot load RSCNN: No module named 'pointnet2_ops'
Cannot load PCT: No module named 'pointnet2_ops'
Cannot load PointMLP: No module named 'pointnet2_ops'
Cannot load PointNet2: No module named 'pointnet2_ops'
Data root: /content/SemNov_AML_DAAI_23-24/3D_OS_release_data
out-of-distribution eval - Modelnet -> SONN ..
Arguments: Namespace(local_rank=None, use_sync_bn=False, use_amp=False, script_mode='eval', config='cfgs/dgcnn-cla.yaml', seed=1, epochs=250, batch_size=1, num_workers=4, resume=None, apply_fix_cellphone=True, data_root='/content/SemNov_AML_DAAI_23-24/3D_OS_release_data', checkpoints_dir='outputs', exp_name='DGCNN_CE_SR1_NO_CORR', eval_step=1, save_step=10, ckpt_path='outputs/DGCNN_CE_SR1_NO_CORR//models/model_best.pth', src='SR1', sonn_split='main_split', sonn_h5_name='objectdataset.h5', augm_set='rw', grad_norm_clip=-1, num_points=1024, num_points_test=2048, wandb_name=None, wandb_group='md-2-sonn-augmCorr', wandb_proj='benchmark-3d-ood-cla', loss='CE', cs=False, cs_gan_lr=0.0002, cs_beta=0.1, save_feats=None, corruption=None, tar1='none', tar2='none')
ModelNet40_OOD - Reading data from h5py file: /content/SemNov_AML_DAAI_23-24/3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR1_train.h5
ModelNet40_OOD - split: train, categories: {'chair': 0, 'bookshelf': 1, 'door': 2, 'sink': 3, 'sofa': 4}
SR1 train data len: 2378
ModelNet40_OOD - Reading data from h5py file: /content/SemNov_AML_DAAI_23-24/3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR1_test.h5
ModelNet40_OOD - split: test, categories: {'chair': 0, 'bookshelf': 1, 'door': 2, 'sink': 3, 'sofa': 4}
Src is SR1

ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {4: 0, 8: 1, 7: 2, 12: 3, 13: 4}, num samples: 1255
ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {10: 0, 14: 1, 5: 2, 6: 3, 9: 2}, num samples: 788
ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {0: 0, 1: 1, 2: 2, 3: 3, 11: 4}, num samples: 847
dgcnn k: 20
dgcnn emb_dims: 1024
Clf - feature encoder: DGCNN
Clf Head - num classes: 5, input dim: 2048, act: leakyrelu, dropout: 0.5
Model params count: 1.8003 M
Load weights:  <All keys matched successfully>
100% 1255/1255 [00:08<00:00, 144.59it/s]
100% 788/788 [00:05<00:00, 151.11it/s]
100% 847/847 [00:05<00:00, 146.87it/s]

################################################################################
Computing OOD metrics with MSP normality score...
AUROC - Src label: 1, Tar label: 0
SR1 over SR1 as id
SR1 over SR2 as ood1
SR1 over ood_common as ood2
Src Test - Clf Acc: 0.7139442231075698, Clf Bal Acc: 0.7008679358019725
SRC->TAR1:      AUROC: 0.7255, FPR95: 0.8997, AUPR_IN: 0.8256, AUPR_OUT: 0.5483
SRC->TAR2:      AUROC: 0.7372, FPR95: 0.8725, AUPR_IN: 0.8313, AUPR_OUT: 0.5881
SRC->TAR1+TAR2: AUROC: 0.7316, FPR95: 0.8856, AUPR_IN: 0.7261, AUPR_OUT: 0.7245
to spreadsheet: 0.7255172204582685,0.899746192893401,0.825636263833521,0.5482854846798825,0.7371773825594905,0.872491145218418,0.8313172135254605,0.5881190487607932,0.7315576836385346,0.8856269113149847,0.7260973068562366,0.7244838948432025
################################################################################

################################################################################
Computing OOD metrics with MLS normality score...
AUROC - Src label: 1, Tar label: 0
SR1 over SR1 as id
SR1 over SR2 as ood1
SR1 over ood_common as ood2
Src Test - Clf Acc: 0.7139442231075698, Clf Bal Acc: 0.7008679358019725
SRC->TAR1:      AUROC: 0.6627, FPR95: 0.8959, AUPR_IN: 0.7792, AUPR_OUT: 0.5091
SRC->TAR2:      AUROC: 0.7083, FPR95: 0.8418, AUPR_IN: 0.7988, AUPR_OUT: 0.5836
SRC->TAR1+TAR2: AUROC: 0.6863, FPR95: 0.8679, AUPR_IN: 0.6679, AUPR_OUT: 0.7058
to spreadsheet: 0.6626873217788745,0.8959390862944162,0.7791694218492484,0.5091199325447134,0.7083072668005664,0.8417945690672963,0.7987627799160973,0.5835761121964285,0.6863204064476041,0.8678899082568807,0.6678743460214047,0.7058071176299475
################################################################################

################################################################################
Computing OOD metrics with entropy normality score...
AUROC - Src label: 1, Tar label: 0
SR1 over SR1 as id
SR1 over SR2 as ood1
SR1 over ood_common as ood2
Src Test - Clf Acc: 0.7139442231075698, Clf Bal Acc: 0.7008679358019725
SRC->TAR1:      AUROC: 0.7205, FPR95: 0.9074, AUPR_IN: 0.8237, AUPR_OUT: 0.5416
SRC->TAR2:      AUROC: 0.7364, FPR95: 0.8760, AUPR_IN: 0.8311, AUPR_OUT: 0.5904
SRC->TAR1+TAR2: AUROC: 0.7287, FPR95: 0.8911, AUPR_IN: 0.7249, AUPR_OUT: 0.7229
to spreadsheet: 0.7204663579185795,0.9073604060913706,0.8237415749567165,0.5415585701242815,0.7363584622548766,0.8760330578512396,0.8310903268505299,0.5903834144570211,0.7286991483606856,0.891131498470948,0.7248844604896152,0.7228534101109274
################################################################################
/usr/local/lib/python3.10/dist-packages/torch/utils/cpp_extension.py:1967: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(

################################################################################
Computing OOD metrics with distance from train features...
100% 1255/1255 [00:08<00:00, 150.99it/s]
100% 2378/2378 [00:10<00:00, 218.01it/s]
100% 788/788 [00:05<00:00, 149.33it/s]
100% 847/847 [00:05<00:00, 149.94it/s]
Euclidean distances in a non-normalized space:
AUROC - Src label: 1, Tar label: 0
SR1 over SR1 as id
SR1 over SR2 as ood1
SR1 over ood_common as ood2
Src Test - Clf Acc: 0.6916334661354582, Clf Bal Acc: 0.6670951096405686
SRC->TAR1:      AUROC: 0.5581, FPR95: 0.9569, AUPR_IN: 0.6865, AUPR_OUT: 0.4053
SRC->TAR2:      AUROC: 0.7236, FPR95: 0.8005, AUPR_IN: 0.7936, AUPR_OUT: 0.6063
SRC->TAR1+TAR2: AUROC: 0.6439, FPR95: 0.8758, AUPR_IN: 0.5893, AUPR_OUT: 0.6742
to spreadsheet: 0.558117782676401,0.9568527918781726,0.6865203368153838,0.4052867820306689,0.723622628729474,0.8004722550177096,0.7935881829442849,0.6062607230880253,0.6438563787662804,0.8758409785932721,0.5892930474441707,0.6742109601146584

Cosine similarities on the hypersphere:
AUROC - Src label: 1, Tar label: 0
SR1 over SR1 as id
SR1 over SR2 as ood1
SR1 over ood_common as ood2
Src Test - Clf Acc: 0.6725099601593626, Clf Bal Acc: 0.6439716197542426
SRC->TAR1:      AUROC: 0.6354, FPR95: 0.9480, AUPR_IN: 0.7737, AUPR_OUT: 0.4564
SRC->TAR2:      AUROC: 0.6918, FPR95: 0.9445, AUPR_IN: 0.7788, AUPR_OUT: 0.5254
SRC->TAR1+TAR2: AUROC: 0.6646, FPR95: 0.9462, AUPR_IN: 0.6486, AUPR_OUT: 0.6588
to spreadsheet: 0.6353985074928712,0.9479695431472082,0.7736687388462448,0.4563648960302518,0.6917505891428384,0.9445100354191264,0.778758169812749,0.5253519082494801,0.6645912984149032,0.946177370030581,0.6486215693474473,0.6587643046549121