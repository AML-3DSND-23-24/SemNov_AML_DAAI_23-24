Cannot import torchlars
Cannot load RSCNN: No module named 'pointnet2_ops'
Cannot load PCT: No module named 'pointnet2_ops'
Cannot load PointMLP: No module named 'pointnet2_ops'
Cannot load PointNet2: No module named 'pointnet2_ops'
Data root: /content/SemNov_AML_DAAI_23-24/3D_OS_release_data
out-of-distribution eval - Modelnet -> SONN ..
Arguments: Namespace(local_rank=None, use_sync_bn=False, use_amp=False, script_mode='eval', config='cfgs/dgcnn-cla.yaml', seed=1, epochs=250, batch_size=1, num_workers=4, resume=None, apply_fix_cellphone=True, data_root='/content/SemNov_AML_DAAI_23-24/3D_OS_release_data', checkpoints_dir='outputs', exp_name='DGCNN_CE_SR1', eval_step=1, save_step=10, ckpt_path='outputs/DGCNN_CE_SR1/models/model_best.pth', src='SR1', sonn_split='main_split', sonn_h5_name='objectdataset.h5', augm_set='rw', grad_norm_clip=-1, num_points=1024, num_points_test=2048, wandb_name=None, wandb_group='md-2-sonn-augmCorr', wandb_proj='benchmark-3d-ood-cla', loss='CE', cs=False, cs_gan_lr=0.0002, cs_beta=0.1, save_feats=None, corruption=None, tar1='none', tar2='none')
ModelNet40_OOD - Reading data from h5py file: /content/SemNov_AML_DAAI_23-24/3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR1_train.h5
ModelNet40_OOD - split: train, categories: {'chair': 0, 'bookshelf': 1, 'door': 2, 'sink': 3, 'sofa': 4}
SR1 train data len: 2378
ModelNet40_OOD - Reading data from h5py file: /content/SemNov_AML_DAAI_23-24/3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR1_test.h5
ModelNet40_OOD - split: test, categories: {'chair': 0, 'bookshelf': 1, 'door': 2, 'sink': 3, 'sofa': 4}
Src is SR1

ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {4: 0, 8: 1, 7: 2, 12: 3, 13: 4}, num samples: 1255
ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {10: 0, 14: 1, 5: 2, 6: 3, 9: 2}, num samples: 788
ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {0: 0, 1: 1, 2: 2, 3: 3, 11: 4}, num samples: 847
dgcnn k: 20
dgcnn emb_dims: 1024
Clf - feature encoder: DGCNN
Clf Head - num classes: 5, input dim: 2048, act: leakyrelu, dropout: 0.5
Model params count: 1.8003 M
Load weights:  <All keys matched successfully>
100% 1255/1255 [00:08<00:00, 146.11it/s]
100% 788/788 [00:05<00:00, 153.22it/s]
100% 847/847 [00:05<00:00, 149.27it/s]

################################################################################
Computing OOD metrics with MSP normality score...
AUROC - Src label: 1, Tar label: 0
SR1 over SR1 as id
SR1 over SR2 as ood1
SR1 over ood_common as ood2
Src Test - Clf Acc: 0.7250996015936255, Clf Bal Acc: 0.6539105322706564
SRC->TAR1:      AUROC: 0.7745, FPR95: 0.8046, AUPR_IN: 0.8526, AUPR_OUT: 0.6441
SRC->TAR2:      AUROC: 0.7181, FPR95: 0.8996, AUPR_IN: 0.8194, AUPR_OUT: 0.5556
SRC->TAR1+TAR2: AUROC: 0.7453, FPR95: 0.8538, AUPR_IN: 0.7351, AUPR_OUT: 0.7479
to spreadsheet: 0.7745277772160092,0.8045685279187818,0.8526172899980617,0.6440867061432414,0.7180976213210909,0.8996458087367178,0.819417224464115,0.5556055162212833,0.7452945404924645,0.8538226299694189,0.7351250657127105,0.747909563019294
################################################################################

################################################################################
Computing OOD metrics with MLS normality score...
AUROC - Src label: 1, Tar label: 0
SR1 over SR1 as id
SR1 over SR2 as ood1
SR1 over ood_common as ood2
Src Test - Clf Acc: 0.7250996015936255, Clf Bal Acc: 0.6539105322706564
SRC->TAR1:      AUROC: 0.7829, FPR95: 0.7678, AUPR_IN: 0.8421, AUPR_OUT: 0.6656
SRC->TAR2:      AUROC: 0.7415, FPR95: 0.8619, AUPR_IN: 0.8201, AUPR_OUT: 0.6030
SRC->TAR1+TAR2: AUROC: 0.7614, FPR95: 0.8165, AUPR_IN: 0.7218, AUPR_OUT: 0.7726
to spreadsheet: 0.7828725706311809,0.7677664974619289,0.8421014948659831,0.6656183349505904,0.741517519061887,0.8618654073199528,0.8200670058668175,0.6030251379392095,0.7614488833656201,0.8165137614678899,0.7218408188149408,0.7725739696954823
################################################################################

################################################################################
Computing OOD metrics with entropy normality score...
AUROC - Src label: 1, Tar label: 0
SR1 over SR1 as id
SR1 over SR2 as ood1
SR1 over ood_common as ood2
Src Test - Clf Acc: 0.7250996015936255, Clf Bal Acc: 0.6539105322706564
SRC->TAR1:      AUROC: 0.7832, FPR95: 0.7500, AUPR_IN: 0.8556, AUPR_OUT: 0.6735
SRC->TAR2:      AUROC: 0.7233, FPR95: 0.8796, AUPR_IN: 0.8212, AUPR_OUT: 0.5750
SRC->TAR1+TAR2: AUROC: 0.7521, FPR95: 0.8171, AUPR_IN: 0.7379, AUPR_OUT: 0.7653
to spreadsheet: 0.7831718810039032,0.75,0.8556084088701003,0.6734640202565457,0.7232651448515266,0.8795749704840614,0.8212229185560989,0.5749724249244724,0.7521376268625803,0.8171253822629969,0.737857724914532,0.7653113040825049
################################################################################
/usr/local/lib/python3.10/dist-packages/torch/utils/cpp_extension.py:1967: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(

################################################################################
Computing OOD metrics with distance from train features...
100% 1255/1255 [00:08<00:00, 153.06it/s]
100% 2378/2378 [00:10<00:00, 220.93it/s]
100% 788/788 [00:05<00:00, 151.18it/s]
100% 847/847 [00:05<00:00, 151.01it/s]
Euclidean distances in a non-normalized space:
AUROC - Src label: 1, Tar label: 0
SR1 over SR1 as id
SR1 over SR2 as ood1
SR1 over ood_common as ood2
Src Test - Clf Acc: 0.7123505976095618, Clf Bal Acc: 0.6415453518240529
SRC->TAR1:      AUROC: 0.6072, FPR95: 0.8515, AUPR_IN: 0.6925, AUPR_OUT: 0.4967
SRC->TAR2:      AUROC: 0.7341, FPR95: 0.8076, AUPR_IN: 0.8004, AUPR_OUT: 0.6365
SRC->TAR1+TAR2: AUROC: 0.6729, FPR95: 0.8287, AUPR_IN: 0.5938, AUPR_OUT: 0.7214
to spreadsheet: 0.6071905272311768,0.8515228426395939,0.6925418491005042,0.49674635338726686,0.7340912618710518,0.807556080283353,0.8004148303637235,0.6365039733091742,0.6729305408336075,0.8287461773700305,0.5938486079547275,0.7213874062180652
################################################################################

Cosine similarities on the hypersphere:
AUROC - Src label: 1, Tar label: 0
SR1 over SR1 as id
SR1 over SR2 as ood1
SR1 over ood_common as ood2
Src Test - Clf Acc: 0.7418326693227092, Clf Bal Acc: 0.6849425713936836
SRC->TAR1:      AUROC: 0.7420, FPR95: 0.8185, AUPR_IN: 0.8253, AUPR_OUT: 0.6174
SRC->TAR2:      AUROC: 0.7677, FPR95: 0.7993, AUPR_IN: 0.8299, AUPR_OUT: 0.6600
SRC->TAR1+TAR2: AUROC: 0.7553, FPR95: 0.8086, AUPR_IN: 0.7188, AUPR_OUT: 0.7757
to spreadsheet: 0.7420167047545857,0.8185279187817259,0.8253316809133767,0.617404668435101,0.7677422541239999,0.7992916174734357,0.829923023526637,0.6600246219690589,0.7553436407276095,0.8085626911314985,0.7188155360498245,0.775747023589701